set-option -sa terminal-overrides ",xterm*:Tc"
set -g mouse on

# Set prefix to Ctrl-Space
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Set vi-mode
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Open panes in current directory
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# enable OSC 52 on the tmux side
set -g set-clipboard on

# Enable passthrough to make image.nvim work
set -gq allow-passthrough on

# Enable keymap passthrough
set-window-option -g allow-passthrough on

# Let tmux know your outer terminal supports features
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set -as terminal-features ",*:RGB:usstyle:hyperlinks"

# Tokyo Night Theme configuration
set -g @powerkit_theme 'tokyo-night'
set -g @powerkit_theme_variant 'storm'
set -g @powerkit_plugins 'ssh,cloud,datetime'
set -g @powerkit_separator_style 'normal'
set -g @powerkit_edge_separator_style 'normal'
set -g @powerkit_plugin_datetime_format '%a %d. %b %H:%M'
set -g @powerkit_show_options_key "M-e"
set -g @powerkit_show_keybindings_key "M-k"
set -g @powerkit_theme_selector_key "M-t"
set -g @powerkit_reload_config_key "M-r"

# Automatic TPM install
if-shell 'test ! -d ~/.tmux/plugins/tpm' \
  'run-shell "git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins"'

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-logging'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'fabioluciano/tmux-powerkit'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
